# WiseUp ê´€ë¦¬ ì‹œìŠ¤í…œ - ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ (ì‚¬ìš©ì ê¸°ë°˜ ê²©ë¦¬ ë²„ì „)

## ğŸ“‹ ê°œìš”

WiseUp ê´€ë¦¬ ì‹œìŠ¤í…œì€ Firebase Firestoreë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ NoSQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ ì‹œìŠ¤í…œì€ **ì‚¬ìš©ì ê¸°ë°˜ ë°ì´í„° ê²©ë¦¬(User-based Data Isolation) ì•„í‚¤í…ì²˜**ë¡œ ì„¤ê³„ë˜ì–´, ê° ì‚¬ìš©ìëŠ” ìì‹ ì˜ ë°ì´í„°ë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ ë²„ì „ì—ì„œëŠ” ê° ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ê°œë³„ì ì¸ ë°ì´í„° ê³µê°„ì„ ê°€ì§€ë©°, ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ë°ì´í„°ì—ëŠ” ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì‚¬ìš©ìëŠ” Firebase Authì˜ UIDë¥¼ í†µí•´ ìì‹ ë§Œì˜ **ê°œì¸ ë°ì´í„°ì—ë§Œ ì ‘ê·¼ ê¶Œí•œ**ì„ ê°€ì§‘ë‹ˆë‹¤.

## ğŸ¯ ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

### ì£¼ìš” ê¸°ëŠ¥

  - ê°œì¸ ì‚¬ìš©ì ê´€ë¦¬ (Google ê³„ì • ì—°ë™ ë¡œê·¸ì¸)
  - ê°œì¸ ì¶œì„ ê´€ë¦¬
  - **ê³ ê¸‰ ì‹œê°„í‘œ ê´€ë¦¬** (2ë ˆì´ì–´ êµ¬ì¡°: ë“±ì›/í•˜ì› + ì„¸ë¶€ì¼ì •)
  - **ì‹œê°„í‘œ ë§í¬ ê³µìœ ** (ì™¸ë¶€ ì‚¬ìš©ìê°€ ì¼ì • ì…ë ¥ ê°€ëŠ¥)
  - **ìë™ ììŠµì‹œê°„ ì±„ìš°ê¸°** (ë¹ˆ ì‹œê°„ëŒ€ë¥¼ ìë™ìœ¼ë¡œ ììŠµìœ¼ë¡œ ì„¤ì •)
  - ê°œì¸ ì¢Œì„ ê´€ë¦¬ (ë°°ì • ë° ë°°ì¹˜ë„)

### ì¸ì¦ ì‹œìŠ¤í…œ

  - **Google ê³„ì • ì—°ë™**: Firebase Auth Google Providerë¥¼ ì‚¬ìš©í•œ ì†Œì…œ ë¡œê·¸ì¸
  - **ì‚¬ìš©ì (User)**: Google ë¡œê·¸ì¸ ì‹œ Firebase Auth UIDë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°œì¸ ë°ì´í„° ê³µê°„ì„ ê°€ì§‘ë‹ˆë‹¤
  - **ë°ì´í„° ê²©ë¦¬**: ê° ì‚¬ìš©ìëŠ” ì™„ì „íˆ ë…ë¦½ì ì¸ ë°ì´í„° ê³µê°„ì„ ê°€ì§€ë©°, ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ë°ì´í„°ëŠ” ë³¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤
  - **í˜‘ì—… ê¸°ëŠ¥**: ì‹œê°„í‘œ ë§í¬ ê³µìœ ë¥¼ í†µí•œ ì œí•œì  ì™¸ë¶€ ì ‘ê·¼ í—ˆìš©

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

### ê¸°ë³¸ êµ¬ì¡°

ì‚¬ìš©ì ê¸°ë°˜ ê²©ë¦¬ ì•„í‚¤í…ì²˜ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤. ê° ì‚¬ìš©ìëŠ” ìì‹ ë§Œì˜ ë…ë¦½ì ì¸ ë°ì´í„° ê³µê°„ì„ ê°€ì§‘ë‹ˆë‹¤.

```
users (ì»¬ë ‰ì…˜)
â””â”€â”€ {userId} (ë¬¸ì„œ) - Firebase Auth UID (Google ê³„ì •)
    â”œâ”€â”€ (ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´ í•„ë“œë“¤)
    â”œâ”€â”€ attendance_records (í•˜ìœ„ ì»¬ë ‰ì…˜)
    â”œâ”€â”€ timetables (í•˜ìœ„ ì»¬ë ‰ì…˜) â† 2ë ˆì´ì–´ êµ¬ì¡°ë¡œ í™•ì¥
    â”œâ”€â”€ shared_schedules (í•˜ìœ„ ì»¬ë ‰ì…˜) â† ì‹œê°„í‘œ ë§í¬ ê³µìœ  ê´€ë¦¬
    â”œâ”€â”€ schedule_contributions (í•˜ìœ„ ì»¬ë ‰ì…˜) â† ì™¸ë¶€ ê¸°ì—¬ ë°ì´í„° ìˆ˜ì§‘
    â”œâ”€â”€ seats (í•˜ìœ„ ì»¬ë ‰ì…˜)
    â”œâ”€â”€ seat_assignments (í•˜ìœ„ ì»¬ë ‰ì…˜)
    â”œâ”€â”€ seat_layouts (í•˜ìœ„ ì»¬ë ‰ì…˜)
    â”œâ”€â”€ class_sections (í•˜ìœ„ ì»¬ë ‰ì…˜)
    â”œâ”€â”€ attendance_summaries (í•˜ìœ„ ì»¬ë ‰ì…˜)
    â””â”€â”€ settings (í•˜ìœ„ ì»¬ë ‰ì…˜)
```

-----

### 1\. ì‚¬ìš©ì ì»¬ë ‰ì…˜ (users) - Google ê³„ì • ê¸°ë°˜

`users/{userId}`

ê° ì‚¬ìš©ìì˜ ê¸°ë³¸ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ë£¨íŠ¸ ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤. ë¬¸ì„œ IDëŠ” Firebase Auth UID(Google ê³„ì •)ì™€ ë™ì¼í•©ë‹ˆë‹¤.

```typescript
interface User {
  authUid: string;                 // Firebase Auth UID (Google ê³„ì •)
  name: string;                    // Google ê³„ì • ì´ë¦„
  email: string;                   // Google ì´ë©”ì¼
  profilePicture?: string;         // Google í”„ë¡œí•„ ì‚¬ì§„ URL
  googleId: string;               // Google ê³„ì • ID
  isActive: boolean;               // ì‚¬ìš©ì ìƒíƒœ (í™œì„±, ë¹„í™œì„±)
  createdAt: FirestoreTimestamp;   // ìƒì„±ì¼
  updatedAt: FirestoreTimestamp;   // ìˆ˜ì •ì¼
}
```

### 2\. ì¶œì„ ê¸°ë¡ ì»¬ë ‰ì…˜ (attendance\_records)

`users/{userId}/attendance_records`

ê° ì‚¬ìš©ìì˜ ê°œì¸ ì¶œì„ ê¸°ë¡ì„ ì €ì¥í•©ë‹ˆë‹¤.

```typescript
type AttendanceStatus = 'present' | 'absent' | 'late' | 'early_leave';

interface AttendanceRecord {
  date: string;                    // ì¶œì„ ë‚ ì§œ (YYYY-MM-DD í˜•ì‹)
  status: AttendanceStatus;        // ì¶œì„ ìƒíƒœ
  seatId?: string;                 // ë°°ì •ëœ ì¢Œì„ ID
  checkInTime?: FirestoreTimestamp; // ì…ì‹¤ ì‹œê°„
  checkOutTime?: FirestoreTimestamp; // í‡´ì‹¤ ì‹œê°„
  notes?: string;                  // ì¶œì„ ê´€ë ¨ ë©”ëª¨
  createdAt: FirestoreTimestamp;   // ìƒì„±ì¼
  updatedAt: FirestoreTimestamp;   // ìˆ˜ì •ì¼
}
```

### 3\. ì‹œê°„í‘œ ì»¬ë ‰ì…˜ (timetables) - 2ë ˆì´ì–´ êµ¬ì¡°

`users/{userId}/timetables`

ê° ì‚¬ìš©ìì˜ ê³ ê¸‰ ì‹œê°„í‘œë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ë“±ì›/í•˜ì› ê¸°ë³¸ í‹€ê³¼ ì„¸ë¶€ ì¼ì •ì„ ë¶„ë¦¬í•˜ì—¬ ê´€ë¦¬í•©ë‹ˆë‹¤.

```typescript
type DayOfWeek = 'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday' | 'saturday' | 'sunday';

interface Timetable {
  name: string;                    // ì‹œê°„í‘œ ì´ë¦„

  // 1ì°¨ ë ˆì´ì–´: ë“±ì›/í•˜ì› ê¸°ë³¸ í‹€
  basicSchedule: {
    arrivalTime: string;           // ë“±ì› ì‹œê°„ "09:00"
    departureTime: string;         // í•˜ì› ì‹œê°„ "18:00"
    daysOfWeek: DayOfWeek[];       // í™œì„± ìš”ì¼ ["monday", "tuesday", ...]
    timeSlotInterval: number;      // ì‹œê°„ ë‹¨ìœ„ (ë¶„) ê¸°ë³¸ê°’: 30
  };

  // 2ì°¨ ë ˆì´ì–´: êµ¬ì²´ì ì¸ ì¼ì •
  detailedSchedule: {
    [dayOfWeek: string]: {         // "monday", "tuesday" ë“±
      timeSlots: {
        startTime: string;         // "10:00"
        endTime: string;           // "11:30"
        subject: string;           // "ìˆ˜í•™", "ì˜ì–´", "ììŠµ"
        type: 'class' | 'self_study'; // ìˆ˜ì—…/ììŠµ êµ¬ë¶„
        isAutoGenerated: boolean;  // ìë™ìƒì„±ëœ ììŠµì‹œê°„ì¸ì§€
        color?: string;            // ì‹œê°„í‘œ í‘œì‹œ ìƒ‰ìƒ
      }[];
    };
  };

  // ê³µìœ  ê¸°ëŠ¥
  isShared: boolean;              // ê³µìœ  í™œì„±í™” ì—¬ë¶€
  shareToken?: string;            // ë§í¬ ê³µìœ ìš© ê³ ìœ  í† í°
  shareSettings: {
    allowEdit: boolean;           // ì™¸ë¶€ í¸ì§‘ í—ˆìš©
    allowView: boolean;           // ì™¸ë¶€ ì¡°íšŒ í—ˆìš©
    expiresAt?: FirestoreTimestamp; // ê³µìœ  ë§Œë£Œì¼
  };

  // ìë™ ì±„ìš°ê¸° ì„¤ì •
  autoFillSettings: {
    enabled: boolean;             // ìë™ ììŠµì‹œê°„ ì±„ìš°ê¸° í™œì„±í™”
    defaultSubject: string;       // ê¸°ë³¸ ììŠµ ê³¼ëª©ëª… "ììŠµ"
    fillEmptySlots: boolean;      // ë¹ˆ ì‹œê°„ ìë™ ì±„ìš°ê¸°
  };

  isActive: boolean;               // í™œì„± ìƒíƒœ
  createdAt: FirestoreTimestamp;   // ìƒì„±ì¼
  updatedAt: FirestoreTimestamp;   // ìˆ˜ì •ì¼
}
```

### 4\. ì‹œê°„í‘œ ê³µìœ  ì»¬ë ‰ì…˜ (shared\_schedules)

`users/{userId}/shared_schedules`

ì‹œê°„í‘œ ë§í¬ ê³µìœ ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤. ì™¸ë¶€ ì‚¬ìš©ìê°€ ì‹œê°„í‘œì— ì¼ì •ì„ ì¶”ê°€í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

```typescript
interface SharedSchedule {
  shareToken: string;             // ê³ ìœ  ê³µìœ  í† í° (UUID)
  timetableId: string;           // ì›ë³¸ ì‹œê°„í‘œ ë¬¸ì„œ ID

  // ê³µìœ  ì„¤ì •
  permissions: {
    canEdit: boolean;            // í¸ì§‘ ê¶Œí•œ (ì¼ì • ì¶”ê°€/ìˆ˜ì •)
    canView: boolean;            // ì¡°íšŒ ê¶Œí•œ
    canComment: boolean;         // ëŒ“ê¸€ ê¶Œí•œ
  };

  // ì ‘ê·¼ ì œì–´
  accessSettings: {
    requireName: boolean;        // ì´ë¦„ ì…ë ¥ í•„ìˆ˜ ì—¬ë¶€
    requireEmail: boolean;       // ì´ë©”ì¼ ì…ë ¥ í•„ìˆ˜ ì—¬ë¶€
    maxContributions?: number;   // ìµœëŒ€ ê¸°ì—¬ íšŸìˆ˜
  };

  // ë§í¬ ê´€ë¦¬
  linkSettings: {
    isActive: boolean;           // ë§í¬ í™œì„± ìƒíƒœ
    expiresAt?: FirestoreTimestamp; // ë§Œë£Œì¼ (ì„ íƒì )
    createdAt: FirestoreTimestamp;  // ìƒì„±ì¼
    lastUsedAt?: FirestoreTimestamp; // ë§ˆì§€ë§‰ ì‚¬ìš©ì¼
    usageCount: number;          // ì‚¬ìš© íšŸìˆ˜
  };

  // ë©”íƒ€ë°ì´í„°
  title?: string;                // ê³µìœ  ë§í¬ ì œëª©
  description?: string;          // ê³µìœ  ë§í¬ ì„¤ëª…
  createdAt: FirestoreTimestamp; // ìƒì„±ì¼
  updatedAt: FirestoreTimestamp; // ìˆ˜ì •ì¼
}
```

### 5\. ì¼ì • ê¸°ì—¬ ì»¬ë ‰ì…˜ (schedule\_contributions)

`users/{userId}/schedule_contributions`

ì™¸ë¶€ ì‚¬ìš©ìê°€ ê³µìœ  ë§í¬ë¥¼ í†µí•´ ì¶”ê°€í•œ ì¼ì • ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤.

```typescript
interface ScheduleContribution {
  shareToken: string;            // ì‚¬ìš©ëœ ê³µìœ  í† í°
  timetableId: string;          // ëŒ€ìƒ ì‹œê°„í‘œ ID

  // ê¸°ì—¬ì ì •ë³´
  contributor: {
    name?: string;               // ê¸°ì—¬ì ì´ë¦„ (ì„ íƒì )
    email?: string;              // ê¸°ì—¬ì ì´ë©”ì¼ (ì„ íƒì )
    ipAddress: string;           // IP ì£¼ì†Œ (ë³´ì•ˆìš©)
  };

  // ê¸°ì—¬í•œ ì¼ì •ë“¤
  contributions: {
    dayOfWeek: string;           // "monday", "tuesday" ë“±
    timeSlots: {
      startTime: string;         // "10:00"
      endTime: string;           // "11:30"
      subject: string;           // "ìˆ˜í•™ ê³¼ì™¸"
      type: 'class' | 'self_study';
      color?: string;            // í‘œì‹œ ìƒ‰ìƒ
      note?: string;             // ì¶”ê°€ ë©”ëª¨
    }[];
  }[];

  // ì²˜ë¦¬ ìƒíƒœ
  status: 'pending' | 'approved' | 'rejected' | 'applied'; // ì²˜ë¦¬ ìƒíƒœ
  appliedAt?: FirestoreTimestamp; // ì‹œê°„í‘œì— ì ìš©ëœ ì‹œê°

  // ë©”íƒ€ë°ì´í„°
  submittedAt: FirestoreTimestamp; // ì œì¶œ ì‹œê°
  processedAt?: FirestoreTimestamp; // ì²˜ë¦¬ ì‹œê°
  processedBy?: string;          // ì²˜ë¦¬ì (ì‹œê°„í‘œ ì†Œìœ ì)
}
```

### 6\. ì¢Œì„ ì •ë³´ ì»¬ë ‰ì…˜ (seats)

`users/{userId}/seats`

ê° ì‚¬ìš©ìì˜ ê°œì¸ ì¢Œì„ ì •ë³´ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.

```typescript
interface Seat {
  seatNumber: string;              // ì¢Œì„ ë²ˆí˜¸
  location: {                      // ì¢Œì„ ìœ„ì¹˜
    x: number;
    y: number;
  };
  status: 'available' | 'occupied' | 'maintenance'; // ì¢Œì„ ìƒíƒœ
  createdAt: FirestoreTimestamp;   // ìƒì„±ì¼
  updatedAt: FirestoreTimestamp;   // ìˆ˜ì •ì¼
}
```

### 5\. ì¢Œì„ ë°°ì • ì»¬ë ‰ì…˜ (seat\_assignments)

`users/{userId}/seat_assignments`

ê° ì‚¬ìš©ìì˜ ì¢Œì„ ë°°ì • ê¸°ë¡ì„ ì €ì¥í•©ë‹ˆë‹¤.

```typescript
type AssignmentStatus = 'active' | 'expired' | 'cancelled';

interface SeatAssignment {
  seatId: string;                  // ë°°ì •ëœ ì¢Œì„ ID
  assignedAt: FirestoreTimestamp;  // ë°°ì • ì‹œê°
  expiresAt?: FirestoreTimestamp;  // ë§Œë£Œ ì‹œê°
  status: AssignmentStatus;        // ë°°ì • ìƒíƒœ
  updatedAt: FirestoreTimestamp;   // ìˆ˜ì •ì¼
}
```

### 6\. ì¢Œì„ ë°°ì¹˜ë„ ì»¬ë ‰ì…˜ (seat\_layouts)

`users/{userId}/seat_layouts`

ê° ì‚¬ìš©ìì˜ ê°œì¸ ì¢Œì„ ë°°ì¹˜ë„ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.

```typescript
interface SeatLayout {
  name: string;                    // ë°°ì¹˜ë„ ì´ë¦„
  layout: {
    seats: {
      id: string;
      position: { x: number; y: number };
      size: { width: number; height: number };
    }[];
    dimensions: {
      width: number;
      height: number;
    };
  };
  createdAt: FirestoreTimestamp;   // ìƒì„±ì¼
  updatedAt: FirestoreTimestamp;   // ìˆ˜ì •ì¼
}
```

### 7\. í•™ê¸‰ ì •ë³´ ì»¬ë ‰ì…˜ (class\_sections)

`users/{userId}/class_sections`

ê° ì‚¬ìš©ìì˜ ê°œì¸ í•™ê¸‰ ì •ë³´ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.

```typescript
interface ClassSection {
  name: string;                    // í•™ê¸‰ëª…
  description?: string;            // í•™ê¸‰ ì„¤ëª…
  schedule: {
    startTime: string;             // ì‹œì‘ ì‹œê°„
    endTime: string;               // ì¢…ë£Œ ì‹œê°„
    daysOfWeek: number[];          // ìš”ì¼ (0: ì¼ìš”ì¼, 1: ì›”ìš”ì¼, ...)
  };
  createdAt: FirestoreTimestamp;   // ìƒì„±ì¼
  updatedAt: FirestoreTimestamp;   // ìˆ˜ì •ì¼
}
```

### 8\. ì¶œì„ ìš”ì•½ ì»¬ë ‰ì…˜ (attendance\_summaries)

`users/{userId}/attendance_summaries`

ê° ì‚¬ìš©ìì˜ ì¶œì„ í†µê³„ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.

```typescript
interface AttendanceSummary {
  period: string;                  // ì§‘ê³„ ê¸°ê°„ (YYYY-MM)
  totalDays: number;               // ì´ ì¼ìˆ˜
  presentDays: number;             // ì¶œì„ ì¼ìˆ˜
  absentDays: number;              // ê²°ì„ ì¼ìˆ˜
  lateDays: number;                // ì§€ê° ì¼ìˆ˜
  earlyLeaveDays: number;          // ì¡°í‡´ ì¼ìˆ˜
  attendanceRate: number;          // ì¶œì„ë¥  (%)
  createdAt: FirestoreTimestamp;   // ìƒì„±ì¼
  updatedAt: FirestoreTimestamp;   // ìˆ˜ì •ì¼
}
```

### 9\. ì„¤ì • ì»¬ë ‰ì…˜ (settings)

`users/{userId}/settings`

ê° ì‚¬ìš©ìì˜ ê°œì¸ ì„¤ì •ì„ ì €ì¥í•©ë‹ˆë‹¤.

```typescript
interface UserSettings {
  notifications: {
    attendance: boolean;           // ì¶œì„ ì•Œë¦¼
    schedule: boolean;             // ìŠ¤ì¼€ì¤„ ì•Œë¦¼
    announcements: boolean;        // ê³µì§€ì‚¬í•­ ì•Œë¦¼
  };
  preferences: {
    theme: 'light' | 'dark';       // í…Œë§ˆ ì„¤ì •
    language: string;              // ì–¸ì–´ ì„¤ì •
  };
  createdAt: FirestoreTimestamp;   // ìƒì„±ì¼
  updatedAt: FirestoreTimestamp;   // ìˆ˜ì •ì¼
}
```

-----

## ğŸ” ë³´ì•ˆ ê·œì¹™ (Firestore Rules) - ì‚¬ìš©ì ê¸°ë°˜ ê²©ë¦¬

ì‚¬ìš©ì ê¸°ë°˜ ê²©ë¦¬ ì•„í‚¤í…ì²˜ë¡œ ë³€ê²½ë˜ë©´ì„œ ë³´ì•ˆ ê·œì¹™ì´ **ë§¤ìš° ë‹¨ìˆœí•˜ê³  ê°•ë ¥**í•´ì¡ŒìŠµë‹ˆë‹¤. ê° ì‚¬ìš©ìëŠ” ìì‹ ì˜ UIDì™€ ì¼ì¹˜í•˜ëŠ” ë°ì´í„°ì—ë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // ì‚¬ìš©ì ê¸°ë°˜ ë°ì´í„° ê²©ë¦¬ - ë¡œê·¸ì¸í•œ ê³„ì •ë³„ë¡œ ë°ì´í„° ë¶„ë¦¬

    // ì‚¬ìš©ìë³„ ë°ì´í„° - uid ê¸°ë°˜ ê²©ë¦¬
    match /users/{userId} {
      // ì‚¬ìš©ìëŠ” ë³¸ì¸ ë°ì´í„°ë§Œ ì ‘ê·¼ ê°€ëŠ¥
      allow read, write: if request.auth != null &&
        request.auth.uid == userId;

      // ì¶œì„ ê¸°ë¡ - í•´ë‹¹ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
      match /attendance_records/{recordId} {
        allow read, write: if request.auth != null &&
          request.auth.uid == userId;
      }

      // ì‹œê°„í‘œ - í•´ë‹¹ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
      match /timetables/{timetableId} {
        allow read, write: if request.auth != null &&
          request.auth.uid == userId;
      }

      // ì¢Œì„ ë°°ì • - í•´ë‹¹ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
      match /seat_assignments/{assignmentId} {
        allow read, write: if request.auth != null &&
          request.auth.uid == userId;
      }

      // ì¢Œì„ ì •ë³´ - í•´ë‹¹ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
      match /seats/{seatId} {
        allow read, write: if request.auth != null &&
          request.auth.uid == userId;
      }

      // í•™ê¸‰ ì •ë³´ - í•´ë‹¹ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
      match /class_sections/{sectionId} {
        allow read, write: if request.auth != null &&
          request.auth.uid == userId;
      }

      // ì¶œì„ ìš”ì•½ - í•´ë‹¹ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
      match /attendance_summaries/{summaryId} {
        allow read, write: if request.auth != null &&
          request.auth.uid == userId;
      }

      // ì¢Œì„ ë°°ì¹˜ë„ - í•´ë‹¹ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
      match /seat_layouts/{layoutId} {
        allow read, write: if request.auth != null &&
          request.auth.uid == userId;
      }

      // ì„¤ì • - í•´ë‹¹ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
      match /settings/{settingId} {
        allow read, write: if request.auth != null &&
          request.auth.uid == userId;
      }

      // ì‹œê°„í‘œ ê³µìœ  ë§í¬ ê´€ë¦¬ - ë³¸ì¸ë§Œ ì ‘ê·¼ ê°€ëŠ¥
      match /shared_schedules/{scheduleId} {
        allow read, write: if request.auth != null &&
          request.auth.uid == userId;
      }

      // ì™¸ë¶€ ì¼ì • ê¸°ì—¬ ìˆ˜ì§‘ - ë³¸ì¸ë§Œ ì ‘ê·¼ ê°€ëŠ¥
      match /schedule_contributions/{contributionId} {
        allow read, write: if request.auth != null &&
          request.auth.uid == userId;
      }

      // ê¸°íƒ€ í•˜ìœ„ ì»¬ë ‰ì…˜ - ê¸°ë³¸ ê¶Œí•œ ì ìš©
      match /{subCollection}/{docId} {
        allow read, write: if request.auth != null &&
          request.auth.uid == userId;
      }
    }

    // ë£¨íŠ¸ ë ˆë²¨ ì»¬ë ‰ì…˜ ì ‘ê·¼ ì°¨ë‹¨ (ë³´ì•ˆ ê°•í™”)
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
```

### ë™ì‘ ë°©ì‹

#### ê¸°ë³¸ ì¸ì¦ ë° ë°ì´í„° ê²©ë¦¬

1.  ì‚¬ìš©ìê°€ Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ë©´ Firebase Authì—ì„œ ê³ ìœ í•œ UIDë¥¼ ë°œê¸‰ë°›ìŠµë‹ˆë‹¤.
2.  ëª¨ë“  ê°œì¸ ë°ì´í„°ëŠ” `/users/{uid}/` ê²½ë¡œ í•˜ìœ„ì— ì €ì¥ë©ë‹ˆë‹¤.
3.  Firestore ë³´ì•ˆ ê·œì¹™ì€ `request.auth.uid`ì™€ ì ‘ê·¼í•˜ë ¤ëŠ” ê²½ë¡œì˜ `{userId}`ê°€ ì¼ì¹˜í•˜ëŠ”ì§€ë§Œ í™•ì¸í•©ë‹ˆë‹¤.
4.  ì¼ì¹˜í•˜ë©´ í•´ë‹¹ ì‚¬ìš©ìì˜ ëª¨ë“  ë°ì´í„°ì— ì ‘ê·¼ì´ í—ˆìš©ë˜ê³ , ì¼ì¹˜í•˜ì§€ ì•Šìœ¼ë©´ ì™„ì „íˆ ì°¨ë‹¨ë©ë‹ˆë‹¤.

#### ê³ ê¸‰ ì‹œê°„í‘œ ê¸°ëŠ¥ ë™ì‘

5.  **2ë ˆì´ì–´ ì‹œê°„í‘œ**:
      * 1ì°¨ ë ˆì´ì–´ì—ì„œ ë“±ì›/í•˜ì› ì‹œê°„ê³¼ ê¸°ë³¸ í‹€ì„ ì„¤ì •
      * 2ì°¨ ë ˆì´ì–´ì—ì„œ êµ¬ì²´ì ì¸ ì¼ì •ì„ ì‹œê°„ëŒ€ë³„ë¡œ ê´€ë¦¬
6.  **ìë™ ììŠµì‹œê°„ ì±„ìš°ê¸°**:
      * ë“±ì› ì‹œê°„ë¶€í„° í•˜ì› ì‹œê°„ê¹Œì§€ ì„¤ì •ëœ ì‹œê°„ ë‹¨ìœ„ë¡œ ë¶„í• 
      * ê¸°ì¡´ ì¼ì •ì´ ì—†ëŠ” ë¹ˆ ì‹œê°„ëŒ€ë¥¼ ìë™ìœ¼ë¡œ "ììŠµ" í•­ëª©ìœ¼ë¡œ ì±„ì›€
      * `isAutoGenerated: true` í”Œë˜ê·¸ë¡œ ìˆ˜ë™/ìë™ ìƒì„± êµ¬ë¶„

#### ì‹œê°„í‘œ ê³µìœ  ì‹œìŠ¤í…œ ë™ì‘

7.  **ê³µìœ  ë§í¬ ìƒì„±**: ì‚¬ìš©ìê°€ ì‹œê°„í‘œ ê³µìœ ë¥¼ í™œì„±í™”í•˜ë©´ ê³ ìœ  í† í° ìƒì„±
8.  **ì™¸ë¶€ ì ‘ê·¼**: ê³µìœ  ë§í¬ë¥¼ ë°›ì€ ì‚¬ëŒì´ ë³„ë„ ì¸ì¦ ì—†ì´ ì¼ì • ì…ë ¥ ê°€ëŠ¥
9.  **ê¸°ì—¬ ë°ì´í„° ìˆ˜ì§‘**: ì™¸ë¶€ ì…ë ¥ ë°ì´í„°ëŠ” `schedule_contributions`ì— ì„ì‹œ ì €ì¥
10. **ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤**: ì‹œê°„í‘œ ì†Œìœ ìê°€ ê¸°ì—¬ ë°ì´í„°ë¥¼ ê²€í†  í›„ ìŠ¹ì¸/ê±°ë¶€
11. **ìë™ ì ìš©**: ìŠ¹ì¸ëœ ì¼ì •ì€ ì›ë³¸ ì‹œê°„í‘œì— ìë™ ë°˜ì˜, ë‚˜ë¨¸ì§€ ì‹œê°„ì€ ììŠµìœ¼ë¡œ ì±„ì›€

#### ë³´ì•ˆ ë° ì ‘ê·¼ ì œì–´

12. **ì™„ì „í•œ ê²©ë¦¬**: ê° ì‚¬ìš©ìëŠ” ìì‹ ì˜ ë°ì´í„°ë§Œ ì ‘ê·¼ ê°€ëŠ¥
13. **ê³µìœ  ì˜ˆì™¸ ì²˜ë¦¬**: ì‹œê°„í‘œ ê³µìœ ëŠ” Cloud Functionsë¥¼ í†µí•´ ì œí•œì ìœ¼ë¡œ ì²˜ë¦¬
14. **ì»¤ìŠ¤í…€ í´ë ˆì„ ë¶ˆí•„ìš”**: Google ì¸ì¦ë§Œìœ¼ë¡œ ëª¨ë“  ê¶Œí•œ ê´€ë¦¬ ì™„ë£Œ

-----

## ğŸš€ ìµœì¢… ì»¬ë ‰ì…˜ êµ¬ì¡° (11ê°œ) - ì‚¬ìš©ì ê¸°ë°˜ ê²©ë¦¬ + ê³ ê¸‰ ì‹œê°„í‘œ

ê° ì‚¬ìš©ìë³„ë¡œ ë…ë¦½ì ì¸ í•˜ìœ„ ì»¬ë ‰ì…˜ì„ ê°€ì§€ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤:

1.  **users** - ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´ (ë£¨íŠ¸ ì»¬ë ‰ì…˜, Google ê³„ì •)
2.  **attendance\_records** - ê°œì¸ ì¶œì„ ê¸°ë¡ (`users/{userId}/attendance_records`)
3.  **timetables** - ê³ ê¸‰ ì‹œê°„í‘œ 2ë ˆì´ì–´ êµ¬ì¡° (`users/{userId}/timetables`)
4.  **shared\_schedules** - ì‹œê°„í‘œ ê³µìœ  ë§í¬ ê´€ë¦¬ (`users/{userId}/shared_schedules`)
5.  **schedule\_contributions** - ì™¸ë¶€ ì¼ì • ê¸°ì—¬ ìˆ˜ì§‘ (`users/{userId}/schedule_contributions`)
6.  **seats** - ê°œì¸ ì¢Œì„ ì •ë³´ (`users/{userId}/seats`)
7.  **seat\_assignments** - ê°œì¸ ì¢Œì„ ë°°ì • (`users/{userId}/seat_assignments`)
8.  **seat\_layouts** - ê°œì¸ ì¢Œì„ ë°°ì¹˜ë„ (`users/{userId}/seat_layouts`)
9.  **class\_sections** - ê°œì¸ í•™ê¸‰ ì •ë³´ (`users/{userId}/class_sections`)
10. **attendance\_summaries** - ê°œì¸ ì¶œì„ ìš”ì•½ (`users/{userId}/attendance_summaries`)
11. **settings** - ê°œì¸ ì„¤ì • (`users/{userId}/settings`)

### ì•„í‚¤í…ì²˜ ê°œì„  ìš”ì•½

#### ğŸ” ë³´ì•ˆ & ê²©ë¦¬

  * **ì™„ì „í•œ ë°ì´í„° ê²©ë¦¬**: ê° ì‚¬ìš©ìëŠ” ìì‹ ì˜ ë°ì´í„°ì—ë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë©°, ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ë°ì´í„°ëŠ” ì™„ì „íˆ ê²©ë¦¬ë©ë‹ˆë‹¤.
  * **ë‹¨ìˆœí•œ ë³´ì•ˆ ê·œì¹™**: Firebase Auth UID ë¹„êµë§Œìœ¼ë¡œ ëª¨ë“  ë³´ì•ˆì´ í•´ê²°ë©ë‹ˆë‹¤.
  * **ì»¤ìŠ¤í…€ í´ë ˆì„ ë¶ˆí•„ìš”**: ì¶”ê°€ì ì¸ ê¶Œí•œ ê´€ë¦¬ë‚˜ í´ë ˆì„ ì„¤ì •ì´ ì „í˜€ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

#### ğŸš€ í™•ì¥ì„± & ì„±ëŠ¥

  * **í™•ì¥ì„±**: ì‚¬ìš©ìê°€ ì¦ê°€í•´ë„ ê°ì ë…ë¦½ì ì¸ ë°ì´í„° ê³µê°„ì„ ê°€ì§€ë¯€ë¡œ í™•ì¥ì„±ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.
  * **ê°œë°œ ë‹¨ìˆœí™”**: ë³µì¡í•œ ê¶Œí•œ ë¶„ê¸°ë‚˜ ë‹¤ì¤‘ í…Œë„ŒíŠ¸ ë¡œì§ì´ ë¶ˆí•„ìš”í•˜ì—¬ ê°œë°œì´ ë§¤ìš° ë‹¨ìˆœí•´ì§‘ë‹ˆë‹¤.
  * **ë°ì´í„° ë¬´ê²°ì„±**: ì‚¬ìš©ìë³„ ì™„ì „ ê²©ë¦¬ë¡œ ë°ì´í„° ì˜¤ì—¼ì´ë‚˜ í˜¼ì¬ ê°€ëŠ¥ì„±ì´ ì „í˜€ ì—†ìŠµë‹ˆë‹¤.

#### ğŸ“… ê³ ê¸‰ ì‹œê°„í‘œ ê¸°ëŠ¥

  * **2ë ˆì´ì–´ ì‹œê°„í‘œ**: ë“±ì›/í•˜ì› ê¸°ë³¸ í‹€ê³¼ ì„¸ë¶€ ì¼ì •ì„ ë¶„ë¦¬í•˜ì—¬ ìœ ì—°í•œ ê´€ë¦¬
  * **ìë™ ììŠµì‹œê°„ ì±„ìš°ê¸°**: ë¹ˆ ì‹œê°„ëŒ€ë¥¼ ìë™ìœ¼ë¡œ "ììŠµ" í•­ëª©ìœ¼ë¡œ ì±„ìš°ëŠ” ì§€ëŠ¥í˜• ê¸°ëŠ¥
  * **ë§í¬ ê³µìœ  ì‹œìŠ¤í…œ**: ì™¸ë¶€ ì‚¬ìš©ìê°€ ì‹œê°„í‘œì— ì¼ì •ì„ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” í˜‘ì—… ê¸°ëŠ¥
  * **ê¸°ì—¬ ë°ì´í„° ê´€ë¦¬**: ì™¸ë¶€ì—ì„œ ì…ë ¥ëœ ì¼ì •ì„ ìŠ¹ì¸/ê±°ë¶€í•  ìˆ˜ ìˆëŠ” ê´€ë¦¬ ì‹œìŠ¤í…œ

#### ğŸ”— ì¸ì¦ & ì†Œì…œ ë¡œê·¸ì¸

  * **Google ê³„ì • ì—°ë™**: Firebase Auth Google Providerë¥¼ í†µí•œ ê°„í¸í•œ ì†Œì…œ ë¡œê·¸ì¸
  * **í”„ë¡œí•„ ì •ë³´ ìë™ ë™ê¸°í™”**: Google ê³„ì •ì˜ ì´ë¦„, ì´ë©”ì¼, í”„ë¡œí•„ ì‚¬ì§„ ìë™ ì—°ë™
  * **ë³´ì•ˆ ê°•í™”**: Googleì˜ 2ë‹¨ê³„ ì¸ì¦ ë“± ê¸°ì¡´ ë³´ì•ˆ ì²´ê³„ í™œìš©